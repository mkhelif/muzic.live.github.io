{{ define "main" }}
    {{- $highlights := slice -}}
    <div class="w-100 d-none d-md-block" data-pagefind-ignore="all">
        <div id="carousel-recent-news" class="glide">
            <div class="glide__track" data-glide-el="track">
                <ul class="glide__slides align-items-center">
                    {{ range (where (where site.RegularPages "Section" "news") "Params.hero" "ne" nil).Limit 5 }}
                        {{ $highlights = $highlights | append .RelPermalink }}
                        <li class="glide__slide text-center mh-100 mw-100">
                            <a href="{{ .RelPermalink }}">
                                <img src="{{ urls.JoinPath .Path .Params.hero | absURL | safeURL }}" alt="{{ .Title }}" width="100%" style="max-width: 1200px">
                            </a>
                        </li>
                    {{ end }}
                </ul>
            </div>

            <div class="glide__arrows" data-glide-el="controls">
                <button class="glide__arrow glide__arrow--left" data-glide-dir="<">
                    <i class="fa fa-caret-left"></i>
                </button>
                <button class="glide__arrow glide__arrow--right" data-glide-dir=">">
                    <i class="fa fa-caret-right"></i>
                </button>
            </div>
        </div>

        <script type="text/javascript">
            new Glide('#carousel-recent-news', {
                type: 'carousel',
                autoplay: 3000,
                hoverpause: false,
                focusAt: 'center',
                perView: 2,
                breakpoints: {
                    1400: { perView: 1 }
                }
            }).mount();
        </script>
    </div>

    <div class="container mt-4" data-pagefind-ignore="all">
        <!-- Other news -->
        <div class="row">
            {{ range $index, $page := (where site.RegularPages "Section" "news").Limit 12 }}
                {{ $visibility := cond (in $highlights $page.RelPermalink) "d-block d-md-none" "" }}
                <div class="col-12 col-sm-6 col-md-3 news-card mb-4 {{ $visibility }}">
                    <a href="{{ .RelPermalink }}" class="d-block position-relative">
                        <img src="{{ urls.JoinPath .Path .Params.cover | absURL | safeURL }}" alt="{{ .Title }}" width="100%" class="news-image rounded-1 mw-100">

                        <h5 class="news-title">{{ .Title }}</h5>
                    </a>
                </div>
            {{ end }}
        </div>
        <div class="row">
            <div class="text-center">
                <a class="btn btn-primary" href="/news">Voir plus</a>
            </div>
        </div>

        <!-- Last live reports -->
        <div class="row">
            <div class="col-12 col-lg-8">
                <h4 class="mb-4 p-3 bg-primary text-dark">Dernières chroniques de concerts</h4>
                {{ range (where site.RegularPages "Section" "reports").Limit 5 }}
                    {{ partial "report-entry.html" . }}
                {{ end }}
                <p class="text-center">
                    <a class="btn btn-primary" href="/reports">Voir plus</a>
                </p>
            </div>

            <div class="col-12 col-lg-4">
                <h4 class="mb-4 p-3 bg-primary text-dark">Dernières critiques d'albums</h4>
                {{ range (where site.RegularPages "Section" "albums").Limit 2 }}
                    {{ partial "report-entry.html" . }}
                {{ end }}
                <p class="text-center">
                    <a class="btn btn-primary" href="/albums">Voir plus</a>
                </p>
            </div>
        </div>

    </div>
{{ end }}
